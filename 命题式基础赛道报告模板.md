# FPGA创新设计大赛 AMD赛道命题式赛道 - 设计报告

---

## 1. 项目概述

### 1.1 项目背景

[简要描述项目背景，包括所选择的设计任务（信号处理任务或神经网络加速器设计任务）]

### 1.2 设计目标

[明确列出本项目的具体设计目标，包括但不限于：]

- 功能目标：[描述要实现的具体功能]
- 性能目标：[描述预期的性能指标]
- 资源优化目标：[描述资源使用优化目标]

### 1.3 技术规格

- **目标平台：** AMD PYNQ-Z2
- **开发工具：** Vitis HLS 2024.2
- **编程语言：** C/C++
- **验证环境：** [描述仿真和验证环境]

---

## 2. 设计原理和功能框图

### 2.1 算法原理

[详细描述所实现算法的数学原理和理论基础]

**核心算法公式：**

```
[在此插入关键的数学公式，使用LaTeX格式]
例如：y = W * x + b
```

### 2.2 系统架构设计

#### 2.2.1 顶层架构

[描述整体系统架构，包括主要模块划分]

```
[在此插入系统顶层架构图]
┌─────────────────────────────────────────────────────┐
│                  顶层设计                             │
├─────────────┬─────────────┬─────────────┬─────────────┤
│   输入模块   │   计算核心   │   控制模块   │   输出模块   │
└─────────────┴─────────────┴─────────────┴─────────────┘
```

#### 2.2.2 核心计算模块设计

[详细描述核心计算模块的设计原理]

**模块功能说明：**

- 模块A：[功能描述]
- 模块B：[功能描述]
- 模块C：[功能描述]

#### 2.2.3 数据流图

[描述数据在各模块间的流动过程]

```
[在此插入数据流图]
输入数据 → 预处理 → 核心计算 → 后处理 → 输出结果
```

### 2.3 接口设计

[描述输入输出接口的设计，包括数据位宽、时序等]

**接口规格：**

- 输入接口：[位宽、时序、协议]
- 输出接口：[位宽、时序、协议]
- 控制接口：[控制信号说明]

---

## 3. 优化方向选择与原理

### 3.1 优化目标分析

根据赛题要求，本设计主要关注以下优化方向：

- [ ] 减少片上存储（BRAM）使用
- [ ] 提升流水线性能（降低 II / 提高吞吐率）
- [ ] 提高性能/资源比（MACs/DSP 或 throughput/BRAM）

### 3.2 优化策略设计

#### 3.2.1 存储优化

**优化原理：**
[描述存储优化的具体方法和原理]

**具体措施：**

- 数据重用策略：[描述]
- 存储层次优化：[描述]
- 缓存设计：[描述]

#### 3.2.2 流水线优化

**优化原理：**
[描述流水线优化的方法]

**具体措施：**

- 循环展开：[描述展开策略]
- 流水线插入：[描述流水线设计]
- 数据依赖处理：[描述]

#### 3.2.3 并行化优化

**优化原理：**
[描述并行化处理的方法]

**具体措施：**

- 任务级并行：[描述]
- 数据级并行：[描述]
- 指令级并行：[描述]

### 3.3 HLS指令优化

[列出使用的关键HLS优化指令]

```cpp
// 示例HLS优化指令
#pragma HLS PIPELINE II=1
#pragma HLS UNROLL factor=4
#pragma HLS ARRAY_PARTITION variable=array type=block factor=2
```

---

## 4. LLM 辅助优化记录

### 4.1 优化阶段一：[阶段名称]

#### 4.1.1 优化目标

[描述这个阶段的具体优化目标]

#### 4.1.2 Prompt 设计

**用户输入：**

```
[在此粘贴发送给LLM的完整prompt]
例如：
我正在使用Vitis HLS优化一个卷积神经网络加速器。当前的设计在PYNQ-Z2平台上
的初始化间隔(II)为8，BRAM使用率为85%。请帮我分析如何通过循环展开和数组
分割来降低II并减少BRAM使用量。

当前代码如下：
[代码片段]

请提供具体的优化建议和HLS指令。
```

#### 4.1.3 LLM 回答

**模型回答：**

```
[在此粘贴LLM的完整回答]
```

#### 4.1.4 优化实施

**采用的建议：**
[列出实际采用的优化建议]

**代码修改：**

```cpp
// 优化前代码
[原始代码片段]

// 优化后代码  
[修改后的代码片段]
```

**实施效果：**

- II改善：[从X降低到Y]
- BRAM使用改善：[从X%降低到Y%]
- 其他改善：[描述]

### 4.2 优化阶段二：[阶段名称]

#### 4.2.1 优化目标

[描述第二阶段的优化目标]

#### 4.2.2 Prompt 设计

**用户输入：**

```
[第二轮优化的prompt]
```

#### 4.2.3 LLM 回答

**模型回答：**

```
[LLM的回答]
```

#### 4.2.4 优化实施

[按照4.1.4的格式填写]

### 4.3 优化阶段三：[如有更多阶段，继续添加]

### 4.4 LLM 辅助优化总结

**总体收益：**

- 性能提升：[具体数值]
- 资源节省：[具体数值]
- 开发效率：[描述LLM如何提高开发效率]

**经验总结：**

- 有效的prompt设计要点：[总结]
- LLM建议的可行性分析：[总结]
- 需要人工验证的关键点：[总结]

---

## 5. 优化前后性能与资源对比报告

### 5.1 测试环境

- **硬件平台：** AMD PYNQ-Z2
- **软件版本：** Vitis HLS 2024.2
- **测试数据集：** [描述测试数据]
- **评估指标：** [列出所有评估指标]

### 5.2 综合结果对比

#### 5.2.1 资源使用对比

| 资源类型 | 优化前 | 优化后 | 改善幅度 | 利用率(优化前) | 利用率(优化后) |
| -------- | ------ | ------ | -------- | -------------- | -------------- |
| BRAM     | [数量] | [数量] | [%]      | [%]            | [%]            |
| DSP      | [数量] | [数量] | [%]      | [%]            | [%]            |
| LUT      | [数量] | [数量] | [%]      | [%]            | [%]            |
| FF       | [数量] | [数量] | [%]      | [%]            | [%]            |

#### 5.2.2 性能指标对比

| 性能指标           | 优化前  | 优化后  | 改善幅度 |
| ------------------ | ------- | ------- | -------- |
| 初始化间隔(II)     | [周期]  | [周期]  | [%]      |
| 延迟(Latency)      | [周期]  | [周期]  | [%]      |
| 吞吐率(Throughput) | [ops/s] | [ops/s] | [%]      |
| 时钟频率           | [MHz]   | [MHz]   | [%]      |

#### 5.2.3 复合性能指标

| 复合指标                        | 优化前 | 优化后 | 改善幅度 |
| ------------------------------- | ------ | ------ | -------- |
| 性能/DSP比 (MACs/DSP)           | [值]   | [值]   | [%]      |
| 吞吐量/BRAM比 (Throughput/BRAM) | [值]   | [值]   | [%]      |
| 能效比 (GOPS/W)                 | [值]   | [值]   | [%]      |

### 5.3 详细分析

#### 5.3.1 资源优化分析

**BRAM优化效果：**
[详细分析BRAM使用的优化效果，包括优化前后的存储映射策略变化]

**DSP优化效果：**
[分析DSP使用效率的提升]

**逻辑资源优化效果：**
[分析LUT和FF使用的变化]

#### 5.3.2 性能优化分析

**流水线效率提升：**
[分析II降低带来的性能提升]

**延迟优化效果：**
[分析延迟降低的原因和效果]

**吞吐率提升分析：**
[分析吞吐率提升的关键因素]

### 5.4 功耗分析

| 功耗类型    | 优化前 | 优化后 | 改善幅度 |
| ----------- | ------ | ------ | -------- |
| 静态功耗(W) | [值]   | [值]   | [%]      |
| 动态功耗(W) | [值]   | [值]   | [%]      |
| 总功耗(W)   | [值]   | [值]   | [%]      |

### 5.5 正确性验证

#### 5.5.1 C代码仿真结果

**仿真配置：**

- 测试用例数量：[数量]
- 测试数据类型：[描述]
- 精度要求：[描述]

**仿真结果：**

- 功能正确性：✅ 通过 / ❌ 未通过
- 输出精度：[具体精度指标]
- 性能验证：[描述]

#### 5.5.2 联合仿真结果

**仿真配置：**

- RTL仿真类型：[Verilog/VHDL]
- 时钟周期：[ns]
- 仿真时长：[周期数]

**仿真结果：**

- 时序正确性：✅ 通过 / ❌ 未通过
- 接口兼容性：✅ 通过 / ❌ 未通过
- 性能匹配度：[%]

#### 5.5.3 硬件验证（如适用）

[如果进行了板级验证，在此描述验证过程和结果]

---

## 6. 创新点总结

### 6.1 技术创新点

[列出本设计的主要技术创新点]

1. **创新点1：** [描述]
2. **创新点2：** [描述]
3. **创新点3：** [描述]

### 6.2 LLM辅助方法创新

[描述在LLM辅助优化方面的创新方法]

### 6.3 工程实现创新

[描述在工程实现方面的创新点]

---

## 7. 遇到的问题与解决方案

### 7.1 技术难点

| 问题描述 | 解决方案    | 效果       |
| -------- | ----------- | ---------- |
| [问题1]  | [解决方案1] | [效果描述] |
| [问题2]  | [解决方案2] | [效果描述] |

### 7.2 LLM辅助过程中的问题

[描述在使用LLM过程中遇到的问题和解决方法]

---

## 8. 结论与展望

### 8.1 项目总结

[总结项目的完成情况和主要成果]

### 8.2 性能达成度

[对照最初设定的目标，分析达成情况]

### 8.3 后续改进方向

[描述可能的进一步优化方向]

---

## 9. 参考文献

[1] [参考文献1]
[2] [参考文献2]
[3] [参考文献3]

---

## 10. 附录

### 10.1 完整代码清单

[如需要，可以在此提供关键代码的完整清单]

### 10.2 详细仿真报告

[如需要，可以附上详细的仿真报告截图]

### 10.3 关键LLM交互记录

[提供最重要的几次LLM交互记录，展示LLM辅助的核心价值]
